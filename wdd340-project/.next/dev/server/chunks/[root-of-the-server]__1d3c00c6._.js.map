{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Owner/Documents/wdd430/wdd430-project/wdd340-project/src/app/api/reviews/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport postgres from \"postgres\";\r\n\r\n// Connect to your database\r\nconst sql = postgres(process.env.POSTGRES_URL!, { ssl: \"require\" });\r\n\r\nexport async function POST(req: NextRequest) {\r\n  try {\r\n    const { productId, rating, comment } = await req.json();\r\n\r\n    // Validate input\r\n    if (!productId || !rating || !comment || comment.trim() === \"\") {\r\n      return NextResponse.json({ error: \"All fields are required\" }, { status: 400 });\r\n    }\r\n\r\n    if (rating < 1 || rating > 5) {\r\n      return NextResponse.json({ error: \"Rating must be between 1 and 5\" }, { status: 400 });\r\n    }\r\n\r\n    // Insert review\r\n    const insertResult = await sql<{ id: string; rating: number; comment: string }[]>`\r\n      INSERT INTO reviews (product_id, rating, comment)\r\n      VALUES (${productId}, ${rating}, ${comment})\r\n      RETURNING id, rating, comment\r\n    `;\r\n\r\n    if (!insertResult[0]) {\r\n      return NextResponse.json({ error: \"Failed to create review\" }, { status: 500 });\r\n    }\r\n\r\n    const newReview = {\r\n      id: insertResult[0].id,\r\n      rating: insertResult[0].rating,\r\n      comment: insertResult[0].comment,\r\n      userName: \"Anonymous\"\r\n    };\r\n\r\n    return NextResponse.json({ review: newReview });\r\n  } catch (error) {\r\n    console.error(\"Error adding review:\", error);\r\n    return NextResponse.json({ error: \"Internal Server Error\" }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,2BAA2B;AAC3B,MAAM,MAAM,IAAA,qJAAQ,EAAC,QAAQ,GAAG,CAAC,YAAY,EAAG;IAAE,KAAK;AAAU;AAE1D,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,EAAE,SAAS,EAAE,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,IAAI;QAErD,iBAAiB;QACjB,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,WAAW,QAAQ,IAAI,OAAO,IAAI;YAC9D,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA0B,GAAG;gBAAE,QAAQ;YAAI;QAC/E;QAEA,IAAI,SAAS,KAAK,SAAS,GAAG;YAC5B,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAiC,GAAG;gBAAE,QAAQ;YAAI;QACtF;QAEA,gBAAgB;QAChB,MAAM,eAAe,MAAM,GAAsD,CAAC;;cAExE,EAAE,UAAU,EAAE,EAAE,OAAO,EAAE,EAAE,QAAQ;;IAE7C,CAAC;QAED,IAAI,CAAC,YAAY,CAAC,EAAE,EAAE;YACpB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA0B,GAAG;gBAAE,QAAQ;YAAI;QAC/E;QAEA,MAAM,YAAY;YAChB,IAAI,YAAY,CAAC,EAAE,CAAC,EAAE;YACtB,QAAQ,YAAY,CAAC,EAAE,CAAC,MAAM;YAC9B,SAAS,YAAY,CAAC,EAAE,CAAC,OAAO;YAChC,UAAU;QACZ;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,QAAQ;QAAU;IAC/C,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF"}}]
}